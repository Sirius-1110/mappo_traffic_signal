[2024-12-27 16:42:51][base_learner.py:338][INFO] [RANK0]: DI-engine DRL Policy
MAVAC(
  (actor_encoder): Identity()
  (critic_encoder): Identity()
  (critic_head): Sequential(
    (0): Linear(in_features=224, out_features=512, bias=True)
    (1): Tanh()
    (2): RegressionHead(
      (main): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): Tanh()
      )
      (last): Linear(in_features=512, out_features=1, bias=True)
    )
  )
  (actor_head): Sequential(
    (0): Linear(in_features=32, out_features=256, bias=True)
    (1): Tanh()
    (2): DiscreteHead(
      (Q): Sequential(
        (0): Sequential(
          (0): Linear(in_features=256, out_features=256, bias=True)
          (1): Tanh()
          (2): Linear(in_features=256, out_features=256, bias=True)
          (3): Tanh()
        )
        (1): Sequential(
          (0): Linear(in_features=256, out_features=4, bias=True)
        )
      )
    )
  )
  (actor): ModuleList(
    (0): Identity()
    (1): Sequential(
      (0): Linear(in_features=32, out_features=256, bias=True)
      (1): Tanh()
      (2): DiscreteHead(
        (Q): Sequential(
          (0): Sequential(
            (0): Linear(in_features=256, out_features=256, bias=True)
            (1): Tanh()
            (2): Linear(in_features=256, out_features=256, bias=True)
            (3): Tanh()
          )
          (1): Sequential(
            (0): Linear(in_features=256, out_features=4, bias=True)
          )
        )
      )
    )
  )
  (critic): ModuleList(
    (0): Identity()
    (1): Sequential(
      (0): Linear(in_features=224, out_features=512, bias=True)
      (1): Tanh()
      (2): RegressionHead(
        (main): Sequential(
          (0): Linear(in_features=512, out_features=512, bias=True)
          (1): Tanh()
        )
        (last): Linear(in_features=512, out_features=1, bias=True)
      )
    )
  )
)
[2024-12-27 16:44:01][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/ckpt_best.pth.tar
[2024-12-27 16:46:51][base_learner.py:338][INFO] [RANK0]: === Training Iteration 0 Result ===
[2024-12-27 16:46:51][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | 209.144012     | -0.000000       | 418.315491     |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 1.373315         | 2.559431    | 0.000000     | -0.000000     |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.000000     | 0.427502      | -0.091556      |
+-------+--------------+---------------+----------------+

[2024-12-27 16:46:51][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_0.pth.tar
[2024-12-27 17:49:10][base_learner.py:338][INFO] [RANK0]: === Training Iteration 1000 Result ===
[2024-12-27 17:49:10][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.002653      | -0.001346       | 0.004827       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.372006         | 2.996280    | -0.000000    | 0.000986      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.012074     | -0.073383     | -1.010299      |
+-------+--------------+---------------+----------------+

[2024-12-27 17:49:10][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_1000.pth.tar
[2024-12-27 18:49:30][base_learner.py:338][INFO] [RANK0]: === Training Iteration 2000 Result ===
[2024-12-27 18:49:30][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.004360      | -0.004706       | 0.005294       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.230113         | 2.667604    | -0.000000    | 0.002705      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.026684     | -0.062126     | -1.172245      |
+-------+--------------+---------------+----------------+

[2024-12-27 18:49:30][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_2000.pth.tar
[2024-12-27 19:52:00][base_learner.py:338][INFO] [RANK0]: === Training Iteration 3000 Result ===
[2024-12-27 19:52:00][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | 0.000247       | -0.003982       | 0.012420       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.198107         | 5.628352    | -0.000000    | 0.006076      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.035866     | -0.024456     | -1.380674      |
+-------+--------------+---------------+----------------+

[2024-12-27 19:52:00][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_3000.pth.tar
[2024-12-27 20:51:44][base_learner.py:338][INFO] [RANK0]: === Training Iteration 4000 Result ===
[2024-12-27 20:51:44][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | 0.009892       | -0.001319       | 0.025964       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.177169         | 1.679855    | 0.000000     | 0.003104      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.021104     | -0.045953     | -1.178802      |
+-------+--------------+---------------+----------------+

[2024-12-27 20:51:44][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_4000.pth.tar
[2024-12-27 21:51:58][base_learner.py:338][INFO] [RANK0]: === Training Iteration 5000 Result ===
[2024-12-27 21:51:58][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.001294      | -0.002631       | 0.005984       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.165544         | 3.453544    | 0.000000     | 0.003353      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.022677     | -0.075593     | -1.119123      |
+-------+--------------+---------------+----------------+

[2024-12-27 21:51:58][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_5000.pth.tar
[2024-12-27 22:54:18][base_learner.py:338][INFO] [RANK0]: === Training Iteration 6000 Result ===
[2024-12-27 22:54:18][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.002417      | -0.003648       | 0.005452       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.149523         | 2.876046    | 0.000000     | 0.002977      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.021865     | -0.042393     | -1.176438      |
+-------+--------------+---------------+----------------+

[2024-12-27 22:54:18][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_6000.pth.tar
[2024-12-27 23:52:52][base_learner.py:338][INFO] [RANK0]: === Training Iteration 7000 Result ===
[2024-12-27 23:52:52][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | 0.000031       | -0.001755       | 0.006419       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.142382         | 2.738272    | 0.000000     | 0.002193      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.016995     | -0.063812     | -1.234412      |
+-------+--------------+---------------+----------------+

[2024-12-27 23:52:52][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_7000.pth.tar
[2024-12-28 00:54:39][base_learner.py:338][INFO] [RANK0]: === Training Iteration 8000 Result ===
[2024-12-28 00:54:39][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.001998      | -0.003223       | 0.005356       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.145267         | 2.554198    | -0.000000    | 0.001869      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.025974     | -0.086266     | -1.251628      |
+-------+--------------+---------------+----------------+

[2024-12-28 00:54:39][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_8000.pth.tar
[2024-12-28 01:55:10][base_learner.py:338][INFO] [RANK0]: === Training Iteration 9000 Result ===
[2024-12-28 01:55:10][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.002664      | -0.004055       | 0.005401       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.130988         | 2.912983    | -0.000000    | 0.003587      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.029982     | -0.060955     | -1.266505      |
+-------+--------------+---------------+----------------+

[2024-12-28 01:55:10][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_9000.pth.tar
[2024-12-28 02:52:50][base_learner.py:338][INFO] [RANK0]: === Training Iteration 10000 Result ===
[2024-12-28 02:52:50][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | 0.000698       | -0.001248       | 0.006554       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.133109         | 2.993353    | 0.000000     | 0.001638      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.019328     | -0.074538     | -1.318582      |
+-------+--------------+---------------+----------------+

[2024-12-28 02:52:50][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_10000.pth.tar
[2024-12-28 03:51:36][base_learner.py:338][INFO] [RANK0]: === Training Iteration 11000 Result ===
[2024-12-28 03:51:36][learner_hook.py:224][INFO] 
+-------+------------+----------------+-----------------+----------------+
| Name  | cur_lr_avg | total_loss_avg | policy_loss_avg | value_loss_avg |
+-------+------------+----------------+-----------------+----------------+
| Value | 0.000100   | -0.000814      | -0.002583       | 0.006026       |
+-------+------------+----------------+-----------------+----------------+
+-------+------------------+-------------+--------------+---------------+
| Name  | entropy_loss_avg | adv_max_avg | adv_mean_avg | approx_kl_avg |
+-------+------------------+-------------+--------------+---------------+
| Value | 0.124388         | 3.538111    | -0.000000    | 0.003260      |
+-------+------------------+-------------+--------------+---------------+
+-------+--------------+---------------+----------------+
| Name  | clipfrac_avg | value_max_avg | value_mean_avg |
+-------+--------------+---------------+----------------+
| Value | 0.026583     | -0.055607     | -1.286405      |
+-------+--------------+---------------+----------------+

[2024-12-28 03:51:36][base_learner.py:338][INFO] [RANK0]: learner save ckpt in ./sumo_arterial7_mappo_baseline/ckpt/iteration_11000.pth.tar
